<!-- frontend/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Image Captioning App</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="main-container">
    <h1>üñºÔ∏è Image Captioning</h1>

    <input type="file" id="imageInput" accept="image/*">
    <select id="language">
      <option value="en">English</option>
      <option value="hi">Hindi</option>
      <option value="te">Telugu</option>
      <option value="ta">Tamil</option>
    </select>
    <button onclick="generateCaption()">Generate Caption</button>

    <div id="preview"></div>
    <p id="caption"></p>
  </div>

  <script>
    async function generateCaption() {
      const imageInput = document.getElementById("imageInput");
      const captionDisplay = document.getElementById("caption");
      const preview = document.getElementById("preview");
      const language = document.getElementById("language").value;

      if (imageInput.files.length === 0) {
        alert("Please select an image.");
        return;
      }

      const image = imageInput.files[0];
      const formData = new FormData();
      formData.append("image", image);
      formData.append("language", language);

      // Preview image
      const reader = new FileReader();
      reader.onload = function (e) {
        preview.innerHTML = `<img id='previewImage' src="${e.target.result}" alt="Preview">`;

      };
      reader.readAsDataURL(image);

      try {
        const response = await fetch("http://127.0.0.1:5000/caption", {
          method: "POST",
          body: formData
        });

        const data = await response.json();

        if (data.caption) {
          captionDisplay.innerText = "Caption: " + data.caption;
        } else {
          captionDisplay.innerText = "Error: " + data.error;
        }
      } catch (error) {
        captionDisplay.innerText = "‚ùå Cannot connect to backend. Make sure Flask server is running.";
        console.error("Connection error:", error);
      }
    }
  </script>
</body>
</html>
